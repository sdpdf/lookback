<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>浪人回顧</title>
    <link rel="stylesheet" href="style.css">

</head>
<body>
    <img id="monthlyImage" alt="Monthly Image" class="month">

    <script>
        // 現在の月を取得（1月 = 0、2月 = 1 ... 12月 = 11）
        var currentDate = new Date();
        var currentMonth = currentDate.getMonth(); // 0から始まるので注意

        // 月ごとのファイル名を配列に格納
        var monthImages = [
            "https:/sdpdf.github.io/archive/Jan.png", "https:/sdpdf.github.io/archive/Feb.png", "https:/sdpdf.github.io/archive/Mar.png", "https:/sdpdf.github.io/archive/Apr.png", "https:/sdpdf.github.io/archive/May.png", "https:/sdpdf.github.io/archive/Jun.png", 
            "https:/sdpdf.github.io/archive/Jul.png", "https:/sdpdf.github.io/archive/Aug.png", "https:/sdpdf.github.io/archive/Sep.png", "https:/sdpdf.github.io/archive/Oct.png", "https:/sdpdf.github.io/archive/Nov.png", "https:/sdpdf.github.io/archive/Dec.png"
        ];

        // 現在の月に対応する画像ファイルを設定
        var imageFile = monthImages[currentMonth];

        // imgタグのsrc属性に画像ファイルをセット
        document.getElementById("monthlyImage").src = imageFile;
    </script>

    <script>
        function getDayOfWeek(date) {
            const days = ["日", "月", "火", "水", "木", "金", "土"];
            return days[date.getDay()];
        }
        function getFormattedDate() {
            const today = new Date();
            const month = today.getMonth() + 1; // 月は0から始まるので+1
            const day = today.getDate();
            let year = 2022;
            // 1月、2月、3月は2023年で計算
            if (month === 1 || month === 2 || month === 3) {
                year = 2023;
            }
            // 2022年度の日付を作成
            const date = new Date(`${year}-${month}-${day}`);
            const dayOfWeek = getDayOfWeek(date);
            return `${month}月${day}日（${dayOfWeek}）`;
        }
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('date').textContent = getFormattedDate();
        });
    </script>



    <h1 class="title">浪人回顧</h1>

    <p id="date" class="date">読み込み中...</p>
    
    <div class="body">

    <table id="timetable">
        <thead>
            <tr>
                <th></th>
                <th>1</th>
                <th>2</th>
                <th>3</th>
                <th>4</th>
                <th>5</th>
                <th>6</th>
                <th>7</th>
                <th>8</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td colspan="9">読み込み中...</td>
            </tr>
        </tbody>
    </table>


    <script>function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }
    function fetchCSV(file) {
        return fetch(file)
            .then(response => response.text())
            .then(text => text.split('\n').map(row => row.split(',')));
    }
    function getDayOfWeek(date) {
        const days = ["日", "月", "火", "水", "木", "金", "土"];
        return days[date.getDay()];
    }
    function determineTerm(month) {
        return month >= 4 && month <= 8 ? 'zenki.csv' : 'kouki.csv';
    }
    async function displayTimetable() {
        const today = new Date();
        const month = today.getMonth() + 1;
        const dayOfWeek = getDayOfWeek(today);
        const termFile = determineTerm(month);
        const timetable = await fetchCSV(termFile);
        const daysOfWeek = ["日", "月", "火", "水", "木", "金", "土"];
        const dayIndex = daysOfWeek.indexOf(dayOfWeek);
        if (dayIndex === -1) {
            document.getElementById('timetable').querySelector('tbody').innerHTML = '<tr><td colspan="9">時間割が見つかりませんでした。</td></tr>';
            return;
        }
        const subjects = timetable[dayIndex] || [];
        const tableCells = subjects.slice(0, 9).map((subject, index) => `<td>${subject || ''}</td>`).join('');
        
        document.getElementById('date').textContent = `${today.getMonth() + 1}月${today.getDate()}日（${dayOfWeek}）`;
        document.getElementById('timetable').querySelector('tbody').innerHTML = `<tr>${tableCells}</tr>`;
    }
    document.addEventListener('DOMContentLoaded', displayTimetable);</script>



    <script>
        async function fetchEvent(date) {
            const response = await fetch('tw.csv');
            const text = await response.text();
            const rows = text.split('\n');
            const events = rows.slice(1).map(row => row.split(','));
            for (let [csvDate, event] of events) {
                if (csvDate === date) {
                    return event;
                }
            }
            return 'イベントが見つかりませんでした。';
        }
        async function displayTodayEvent() {
            const today = new Date();
            const month = today.getMonth() + 1; // 月は0から始まるので+1
            const day = today.getDate();
            const date = `${month}/${day}`;
            const event = await fetchEvent(date);
            document.getElementById('result').innerHTML = `${event}`;
        }
        document.addEventListener('DOMContentLoaded', displayTodayEvent);
    </script>


    <p id="result">読み込み中...</p>
</div>
</body>
</html>
